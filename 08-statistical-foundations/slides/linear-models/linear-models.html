<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>DSC365: Introduction to Data Science</title>
    <meta charset="utf-8" />
    <meta name="author" content="Linear Models" />
    <meta name="date" content="2025-10-07" />
    <script src="libs/header-attrs-2.27/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# DSC365: Introduction to Data Science
]
.author[
### Linear Models
]
.date[
### October 7, 2025
]

---




### Announcements

**Lab 4**

- Due Thursday October 9th, 2025 at 11:59 pm in Blueline

**Quiz 2**

- Last 30 minutes of class Thursday October 9th
- Topics: Data Communication and Statistical Foundations/Linear Models

**Lab 5**: work day in class on Thursday October 9th

- Due Tuesday October 21st, 2025 at 11:59 pm in Blueline

**Mini Project 2**

- Due Thursday October 23rd at 11:59 in Blueline



---
### Language of Models

Sometimes we want to know whether any variables are related, thus we need to fit a statistical model.

- We will focus on linear models, but many other types of models too!

.pull-left[
![](linear-models_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;
].pull-right[
![](linear-models_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;

]


---
### Fit a model

Sometimes we want to know whether any variables are related, thus we need to fit a statistical model. 

__Statistical models__: 

&lt;br&gt;
&lt;br&gt;

There are two things we can do with fitting a model:

---
### Fit a model

Today's lecture (and mini-project 2) focuses on interpretation, while mini-project 3 will focus on prediction. General steps for fitting a model for interpretation: 

---
### Vocabulary

- **Response variable**: 

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

- **Explanatory variables**: 
  
---
### Benefits and Drawbacks of Models

- **Benefits**:

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

- **Drawbacks**: 

---
### Looking for the potential correlation

__Example__: Review our NYC flight data. Is there any variable related to the arrival delay? If yes, how?

Consider a random sample of 1000 flights from NYC to Chicago in 2013.



Below are the column names of the data. Suppose we want to focus on if the time of the flights (`hour`) is related to the arrival delay (`arr_delay`)?


``` r
colnames(Chicago1000)
```



```
##      [,1]             [,2]             [,3]       [,4]       
## [1,] "year"           "dep_delay"      "flight"   "distance" 
## [2,] "month"          "arr_time"       "tailnum"  "hour"     
## [3,] "day"            "sched_arr_time" "origin"   "minute"   
## [4,] "dep_time"       "arr_delay"      "dest"     "time_hour"
## [5,] "sched_dep_time" "carrier"        "air_time" ""
```
 
---
### Visualizing a Model

The next step is to use a model. 
  + A popular model we can use is a Linear Model.



``` r
Chicago1000 %&gt;% 
  ggplot(aes(x = hour, y = arr_delay)) + geom_point() + 
  geom_smooth(method = "lm") +
  theme(axis.title.x = element_text(size = 18),
        axis.title.y = element_text(size = 18))
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;


---
### Linear model

__Population Linear model__: The relation between the observation `\(Y\)` and independent variables `\(X_1,..., X_p\)` is formulated as 
`$$Y = \beta_0 + \beta_1X_1 + ... + \beta_pX_p + \epsilon$$`
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;



__Sample Linear model__: `$$Y = \hat{\beta_0} + \hat{\beta_1}X_1 + ... + \hat{\beta_p}X_p$$`


  
---
### Linear Model: One Numerical Predictor


``` r
model = lm(arr_delay ~ hour, data = Chicago1000)
summary(model)
```

```
## 
## Call:
## lm(formula = arr_delay ~ hour, data = Chicago1000)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -69.14 -25.96 -10.22   8.21 389.28 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -19.5500     4.2317  -4.620 4.34e-06 ***
## hour          2.0384     0.3094   6.587 7.23e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 46.13 on 998 degrees of freedom
## Multiple R-squared:  0.04167,	Adjusted R-squared:  0.04071 
## F-statistic: 43.39 on 1 and 998 DF,  p-value: 7.227e-11
```

---
### Linear Model: One Numerical Predictor

**Linear Model**:

&lt;br&gt;



**Coefficient Interpretation**:

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

**Significance of Variable:** Hypothesis Test


  
---
### Linear Model: One Categorical Predictor

**Example**: What about carrier? 

&lt;img src="linear-models_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;




---
### Linear Model: One Categorical Predictor

When a categorical explanatory variable has many levels, they're encoded to **dummy variables**
  

  
  
| carrier        | AA           | B6  | MQ| 9E | WN |
| ------------- |:----:| -----:|-----:|-----:|-----:|-----:|
| UA | 0 | 0 | 0 |  0 | 0|
| AA | 1 | 0 | 0 |  0 | 0|
| B6 | 0 | 1 | 0 |  0 | 0|
| MQ | 0 | 0 | 1 |  0 | 0|
| 9E | 0 | 0 | 0 |  1 | 0|
| WN | 0 | 0 | 0 |  0 | 1|

---
### Linear Model: One Categorical Predictor


``` r
Chicago1000$carrier = relevel(as.factor(Chicago1000$carrier), 
                              ref = "UA")

model2 = lm(arr_delay ~ carrier, data = Chicago1000)
broom::tidy(model2)
```

```
## # A tibble: 6 Ã— 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)     4.86      2.59     1.88  0.0607 
## 2 carrier9E       4.35      6.33     0.688 0.492  
## 3 carrierAA     -10.7       3.76    -2.83  0.00468
## 4 carrierB6      20.8       7.58     2.74  0.00620
## 5 carrierMQ      12.7       5.30     2.40  0.0165 
## 6 carrierWN      12.6       4.24     2.98  0.00297
```

Carrier UA is the reference level and every other levels will be compared to it.

---
### Linear Model with Categorical Explanatory

Writing out the proper model:

`$$\hat{\text{y}} = 4.86+4.35*\text{9E}-10.7*\text{AA}+20.8*\text{B6}+12.7*\text{MQ}+12.6*\text{WN}$$`


**For UA (Reference level)**:

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;



**For AA:** 


---
### Linear Model with Categorical Explanatory

Interpreting p-value: 




---
### Analysis of Variance (ANOVA)

**Analysis of variance**: used to analyze the differences among means.


**Question**: Does at least one of the carriers have a different mean arrival delay than the others


``` r
model3 = aov(arr_delay ~ carrier, data = Chicago1000)
summary(model3)
```

```
##              Df  Sum Sq Mean Sq F value  Pr(&gt;F)    
## carrier       5   95301   19060   8.932 2.6e-08 ***
## Residuals   994 2121209    2134                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```




---
### Confounding Variables

.center[
**"Correlation does not equal causation."**
]



---
### Carrier as a confounder?

__Example__: Does carrier confound the relationship between arrival delay and hour?


``` r
Chicago1000 %&gt;% ggplot(aes(x = hour, y = arr_delay)) + 
  geom_point() + 
  geom_smooth(method = "lm") + 
  aes(color = carrier)
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;


---
#### Multiple Linear Regression


``` r
model4 = lm(arr_delay ~ hour + carrier, data = Chicago1000)
```


```
## 
## Call:
## lm(formula = arr_delay ~ hour + carrier, data = Chicago1000)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -64.26 -24.12 -10.68   8.32 390.10 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -19.4396     4.6483  -4.182 3.14e-05 ***
## hour          1.9055     0.3051   6.246 6.25e-10 ***
## carrier9E     2.8147     6.2161   0.453  0.65078    
## carrierAA    -9.9018     3.6933  -2.681  0.00746 ** 
## carrierB6    20.2891     7.4437   2.726  0.00653 ** 
## carrierMQ    11.9620     5.1993   2.301  0.02161 *  
## carrierWN    11.6865     4.1668   2.805  0.00513 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 45.34 on 993 degrees of freedom
## Multiple R-squared:  0.07917,	Adjusted R-squared:  0.07361 
## F-statistic: 14.23 on 6 and 993 DF,  p-value: 1.337e-15
```

---
### Overall F Test

Testing for significance of all predictor variables at once: 
- `\(H_0\)`:

&lt;br&gt;
&lt;br&gt;

- `\(H_A\)`: 


---
### Individual Significance Tests

Similar to model with one predictor variable, but p-value is calculated assuming all of the other variables are in the model.

- `\(H_0\)`:

&lt;br&gt;
&lt;br&gt;

- `\(H_A\)`: 




---
### Variable Selection

- Adjusted `\(R^2\)`
- AIC/BIC
- Prediction Accuracy (after Fall Break)

**Note**: This is far from an exhaustive list

---
### Adjusted `\(R^2\)`

How much of the variation in our response is explained by the model

The Adjusted `\(R^2\)` does not automatically increase for additional variables

&lt;br&gt;
&lt;br&gt;



---
### AIC and BIC


- AIC: penalize the inclusion of additional variables to a model. It adds a penalty that increases the error when including additional terms. 

``` r
AIC(model4)
```

```
## [1] 10475.09
```

&lt;br&gt;
&lt;br&gt;

- BIC: Stronger penalty for including additional variables to the model.


``` r
BIC(model4)
```

```
## [1] 10514.35
```


---
### Now we can create a linear model, but is it appropriate?

Has 5 Assumptions that needs to be met:


---
### Assumption: Normality

- If the response has a non-normal distribution, the estimates will be biased

To check this assumption, we use a QQ-Plot
  - A scatterplot created by plotting two sets of quantiles against one another.
  - If data is normal, we should see a roughly straight line
  

``` r
plot(model4, which = 2)
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---
### Assumption: Linearity

Look at the Residuals vs Fitted Plot
- Look to see if there are any noticeable pattern in any of the plots
&lt;br&gt;


``` r
plot(model4, which = 1)
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

---
### Assumption: Constant Variance

- Looking for a constant spread of the residuals
- Don't want to see a narrowing or widening of points (fan shaped)


``` r
plot(model4, which = 3)
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;

---
### Assumption: No Perfect Collinearity

Collinearity - a linear relationship between two explanatory variables

&lt;br&gt;


Why bad?

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
  
When is this an issue?



---
### Assumption: No Perfect Collinearity

Let's look at the relationship between `air_time` and `distance`


``` r
library(corrplot)
M &lt;- cor(Chicago1000[,c(15:16)])
corrplot(M, method = "number", type = "upper")
```

&lt;img src="linear-models_files/figure-html/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /&gt;


---
### Last Thing

- Non-constant variance is one of the most common model violations, however it is usually fixable by transforming the response (y) variable.
  + Common transformation is the log-transformation or square root

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

- If you notice a curve in your data, you can add a quadratic term
  + `\(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X_1 + \hat{\beta_2}X_1^2\)`
  + `lm(arr_delay ~ hour + I(hour^2), data = Chicago1000)`



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
