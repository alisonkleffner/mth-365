---
title: "DSC365: Introduction to Data Science"
author: "Data Wrangling: dplyr"
date: "February 3, 2026"
output: 
  xaringan::moon_reader:
    lib_dir: libs
    seal: false
    css: ["default", "metropolis-fonts", "modal.css", "sizeformat.css"]
    includes:
      after_body:
        "js-addins.html"
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
---

```{r echo=FALSE, message=FALSE, warning = FALSE}
library(tidyverse)
library(knitr)
library(ggsci)
library(gridExtra)

hook_output = knit_hooks$get('output')
knit_hooks$set(output = function(x, options) {
  # this hook is used only when the linewidth option is not NULL
  if (!is.null(n <- options$linewidth)) {
    x = xfun::split_lines(x)
    # any lines wider than n should be wrapped
    if (any(nchar(x) > n)) x = strwrap(x, width = n)
    x = paste(x, collapse = '\n')
  }
  hook_output(x, options)
})

```

```{r, include = F, eval = T, cache = T}
clean_file_name <- function(x) {
  basename(x) %>% str_remove("\\..*?$") %>% str_remove_all("[^[A-z0-9_]]")
}

img_modal <- function(src, alt = "", id = clean_file_name(src), other = "") {
  
  other_arg <- paste0("'", as.character(other), "'") %>%
    paste(names(other), ., sep = "=") %>%
    paste(collapse = " ")
  
  js <- glue::glue("<script>
        /* Get the modal*/
          var modal{id} = document.getElementById('modal{id}');
        /* Get the image and insert it inside the modal - use its 'alt' text as a caption*/
        var img{id} = document.getElementById('img{id}');
          var modalImg{id} = document.getElementById('imgmodal{id}');
          var captionText{id} = document.getElementById('caption{id}');
          img{id}.onclick = function(){{
            modal{id}.style.display = 'block';
            modalImg{id}.src = this.src;
            captionText{id}.innerHTML = this.alt;
          }}
          /* When the user clicks on the modalImg, close it*/
          modalImg{id}.onclick = function() {{
            modal{id}.style.display = 'none';
          }}
</script>")
  
  html <- glue::glue(
     " <!-- Trigger the Modal -->
<img id='img{id}' src='{src}' alt='{alt}' {other_arg}>
<!-- The Modal -->
<div id='modal{id}' class='modal'>
  <!-- Modal Content (The Image) -->
  <img class='modal-content' id='imgmodal{id}'>
  <!-- Modal Caption (Image Text) -->
  <div id='caption{id}' class='modal-caption'></div>
</div>
"
  )
  write(js, file = "js-addins.html", append = T)
  return(html)
}
# Clean the file out at the start of the compilation
write("", file = "js-addins.html")
```
class:inverse

<br><br><br>
## DSC365: Intro to Data Science
### Data Wrangling: dplyr
#### February 3, 2026

---
### Announcements

- Start Lab 3 in class on Thursday!
  + Due **Tuesday February 17th, 2026 at 11:59 pm** 
  
- Quiz #1
  + Last 30 Minutes on Thursday February 5
  + Intro to R, Quarto, ggplot2, dplyr 
  
- **Mini-Project 1**
  + Due **Thursday February 12th, 2026 at 3:29 pm** (ie. before class starts)
  + Presentations during class that day


---
### What is Data Wrangling?

Most **datasets** are made up of *rows* and *columns*. They are  a collection of *values*: these can be *numbers* (quantitative) or character *strings* (qualitative)

**Data Wrangling** can be defined as the process of cleaning, organizing, and transforming  raw data into the desired format for analysts to use for prompt decision making. 

```{r, echo=FALSE, fig.alt="This is a visualization of the data science flowchart, where the steps related to data wrangling are highlighted. The steps involve importing the data, tidying the data, and transforming the data."}

knitr::include_graphics("../../04-dplyr/slides/images/data-flowchart.png")

```

[Data Wrangling Flowchart](https://r4ds.had.co.nz/wrangle-intro.html) by Hadley Wickham and Garrett Grolemund

---

### Why do you need this "Data Wrangling" Skill?

- Data wrangling helps to improve data usability as it converts data into a compatible format for the end system.

- It helps to quickly build data flows within an intuitive user interface and easily schedule and automate the data-flow process.

- Integrates various types of information and their sources (like databases, web services, files, etc.)

- Help users to process very large volumes of data easily and easily share data-flow techniques.

[Source](https://www.simplilearn.com/data-wrangling-article#:~:text=Data%20wrangling%20helps%20to%20improve,automate%20the%20data%2Dflow%20process)

---
### What is tidy data?

```{r, echo=FALSE, out.width="90%", fig.alt="This is a visualization connecting the definition of a tidy dataset to a picture of a dataset."}

knitr::include_graphics("../../04-dplyr/slides/images/tidy-data-illustration.png")

```

Real datasets can, and often do, violate the three principles of tidy data in almost every way imaginable! 

---
### Data is usually in a spreadsheet format, but

There are different ways of encoding the same information

.pull-left[
#### Option 1

```{r, echo=FALSE, out.width="70%", fig.alt="Example 1 of a dataset in spreadsheet format. Have three columns for patient, treatment A, and treatment B with 3 observations."}

knitr::include_graphics("../../04-dplyr/slides/images/untidy1.png")

```

#### Option 2
```{r, echo=FALSE, out.width="80%", fig.alt="Example 2 of a dataset in spreadsheet format. Have four columns for patient and each of the three names of the patients. The rows are for each treatment."}

knitr::include_graphics("../../04-dplyr/slides/images/untidy2.png")

```
].pull-right[
#### Option 3
```{r, echo=FALSE, out.width="80%", fig.alt="Example 3 of a dataset in spreadsheet format. Have three columns for patient, treatment, and score. Has six rows, one for each person and treatment combination."}

knitr::include_graphics("../../04-dplyr/slides/images/tidy-data.png")

```
]


---
### dplyr

dplyr is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges.

Rules of `dyplr`:

- First argument is always a data frame
- Subsequent arguments say what to do with that data frame
- Always returns a data frame

```{r, echo=FALSE, out.width="70%", fig.align='center', fig.alt="This is a picture of the hex logo for dplyr along with the four main dplyr verbs."}

knitr::include_graphics("../../04-dplyr/slides/images/dplyr.png")

```

---
### dplyr uses the Pipe (%>%) Operator

Use the pipe operator to combine dplyr functions in chain, which allows us to perform more complicated data manipulations

In programming, a pipe is a technique for passing information from one process to another.

+ Syntax:  dataframe %>% dplyr_function()
+ read %>% as "then do"
+ f(x) %>% g(y) is equivalent to g(f(x),y)
+ Recently `R` has developed the native pipe operator: `|>`

```{r, echo=FALSE, fig.align='center', fig.alt="Illustration of how the pipe operator that is a part of tidyverse works in connecting dplyr verbs together in the same line of code."}

knitr::include_graphics("../../04-dplyr/slides/images/pipe.png")

```

---
### dplyr Terminology

There are some of the primary dplyr verbs, representing distinct data analysis tasks:

`select()`: Select particular columns of a data frame

`filter()`: Select specified rows of a data frame, produce subsets

`arrange()`: Reorder the rows of a data frame

`mutate()`: Add new or change existing columns of the data frame (as functions of existing columns)

`summarise()`: Create collapsed summaries of a data frame

`group_by`: Introduce structure to a data frame

---
### `select()`

`select()`: Select particular columns of a data frame

.center[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Illustration of how the select function works."}

i1 <- img_modal(src = "./images/select.png", alt = "Illustration of how the select function works (from MDSR book)", other=list(width="100%"))

c(str_split(i1, "\\n", simplify = T)[1:2],
  str_split(i1, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

]


---
### `filter()`

`filter()`: Select specified rows of a data frame, produce subsets

.pull-left[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Cartoon of how the filter function works."}

i1 <- img_modal(src = "./images/filter.png", alt = "Cartoon of how the filter function works (by Allison Horst)", other=list(width="100%"))

c(str_split(i1, "\\n", simplify = T)[1:2],
  str_split(i1, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

].pull-right[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Illustration of how the filter function works with a dataset."}

i2 <- img_modal(src = "./images/filter2.png", alt = "Illustration of how the filter function works with a dataset (from MDSR book)", other=list(width="100%"))

c(str_split(i2, "\\n", simplify = T)[1:2],
  str_split(i2, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

]


---
### `mutate()`

`mutate()`: Add new or change existing columns of the data frame (as functions of existing columns)

.pull-left[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Cartoon of how the mutate function works."}

i1 <- img_modal(src = "./images/mutate.png", alt = "Cartoon of how the mutate function works (by Allison Horst)", other=list(width="100%"))

c(str_split(i1, "\\n", simplify = T)[1:2],
  str_split(i1, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

].pull-right[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Illustration of how the mutate function works with a dataset."}

i2 <- img_modal(src = "./images/mutate2.png", alt = "Illustration of how the mutate function works with a dataset (from MDSR book)", other=list(width="100%"))

c(str_split(i2, "\\n", simplify = T)[1:2],
  str_split(i2, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

]

---
### `arrange()`

`arrange()`: Reorder the rows of a data frame

.center[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Illustration of how the arrange function works with a dataset."}

i1 <- img_modal(src = "./images/arrange.png", alt = "Illustration of how the arrange function works with a dataset (from MDSR book)", other=list(width="100%"))

c(str_split(i1, "\\n", simplify = T)[1:2],
  str_split(i1, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

]

---
### `summarize()`

`summarise()`: Create collapsed summaries of a data frame

.center[

```{r, results='asis', echo=FALSE, fig.align='center', fig.alt="Illustration of how the summarize function works with a dataset."}

i1 <- img_modal(src = "./images/summarize.png", alt = "Illustration of how the summarize function works with a dataset (from MDSR book)", other=list(width="100%"))

c(str_split(i1, "\\n", simplify = T)[1:2],
  str_split(i1, "\\n", simplify = T)[3:9]
  ) %>% paste(collapse = "\n") %>% cat()

```

]
